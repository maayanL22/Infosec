unlocking information security lesson 2.4 hackxercise 6 final:

from Crypto.Cipher import AES
from Crypto import Random




def aes_encrypt(plaintext, k):
    pass # return iv + ciphertext (in bytes)
    #plaintext = to_bytes(plaintext.encode('utf-8'))
    #print(plaintext)
    #print(k)
    #print("plain: ", plaintext)
    iv = Random.new().read(AES.block_size)
    cipher = AES.new(k,AES.MODE_CBC, iv)
    #print(plaintext)
    #print(cipher.encrypt(plaintext))
    #print(iv)
    #print(iv + cipher.encrypt(plaintext))
    #print("plain text: ",plaintext)
    return (iv + cipher.encrypt(plaintext))
    


def aes_decrypt(ciphertext, k):
    pass # return plaintext (in 'latin1')
    iv = ciphertext[:AES.block_size]
    #print(iv)
    cipher = AES.new(k, AES.MODE_CBC, iv)
    #print(cipher.decrypt(ciphertext[AES.block_size:]).decode('utf-8'))
    return cipher.decrypt(ciphertext[AES.block_size:]).decode('utf-8')
    